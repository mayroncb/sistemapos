<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <f:view contentType="text/html">
        <h:head>
            <f:facet name="first">
                <meta content='text/html; charset=UTF-8' http-equiv="Content-Type"/>
                <link type="text/css" rel="stylesheet" href="#{facesContext.externalContext.requestContextPath}/resources/css/interface.css" />
                <title>L3 Sistema</title>
            </f:facet>
        </h:head>

        <h:body>
            <h:form id="form" class="forms">
                <p:growl id="growl"   life="2000" showDetail="true"/>
                <p:wizard flowListener="#{cadastroMB.onFlowProcess}">
                    <p:tab id="pessoal" title="Cliente">
                        <p:panel header="Dados do Cliente" style="width: 100%">
                            <p:messages />
                            <fieldset>
                                <legend>Dados do Cliente</legend>
                                <table class="corpo">
                                    <tr class="linha">
                                        <td class="padraoColuna-200"></td>
                                        <td></td>
                                        <td class="padraoColuna-100"></td>
                                        <td></td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputText  value="Nome " />
                                    </td>
                                    <td>
                                    <p:inputText  id="nome" requiredMessage="Campo * Nome Obrigatorio" required="true" size="30" 
                                                 value="#{cadastroMB.cliente.nome}" />
                                    </td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputText value="Email " />
                                    </td>
                                    <td>
                                    <p:inputText value="#{cadastroMB.cliente.email}" size="30"   label="Email"/>
                                    </td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputText value="CPF/CNPJ " /></td>
                                    <td>
                                    <p:inputMask mask="999.999.999-99" value="#{cadastroMB.cliente.cpf}"   label="CPF" /></td>
                                    <td>
                                    <h:outputText value="Telefone" /></td>
                                    <td>
                                    <p:inputMask  mask="(99)9999-9999" size="10" value="#{cadastroMB.cliente.telefone}" label="Telefone"/>
                                    </td>
                                    </tr>
                                </table>

                                <p:separator/>
                                <legend>Endereco do Cliente</legend>
                                <p:separator/>
                                <table>
                                    <tr class="linha">
                                        <td class="padraoColuna-200"></td>
                                        <td></td>
                                        <td class="padraoColuna-100"></td>
                                        <td></td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Rua"/></td>
                                    <td>
                                    <p:inputText value="#{cadastroMB.cliente.endereco.rua}" size="30" label="rua" />
                                    </td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Bairro"/></td>
                                    <td>
                                    <p:inputText value="#{cadastroMB.cliente.endereco.bairro}" size="30" label="rua" />
                                    </td>
                                    <td>
                                    <h:outputText value="Numero "/>
                                    </td>
                                    <td><p:inputText size="8" value="#{cadastroMB.cliente.endereco.numero}" label="Numero" /></td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Cidade "/></td>
                                    <td >
                                    <p:inputText value="#{cadastroMB.cliente.endereco.cidade}" size="30" label="Cidade" />
                                    </td>
                                    <td>
                                    <h:outputText value="Cep "/>
                                    </td>
                                    <td><p:inputMask mask="99.999-999" size="8" value="#{cadastroMB.cliente.endereco.cep}" label="Cep" /></td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Estado"/></td>
                                    <td>
                                    <p:inputText value="#{cadastroMB.cliente.endereco.estado}" size="50" label="Estado" />
                                    </td>
                                    </tr>
                                </table>
                            </fieldset>

                        </p:panel>
                    </p:tab>

                    <p:tab id="obra" title="Obra">
                        <p:panel header="Projeto">
                            <fieldset>
                                <legend>Dados do Terreno</legend>
                                <table class="corpo">
                                    <tr class="linha">
                                        <td class="padraoColuna-200"></td>
                                        <td></td>
                                        <td class="padraoColuna-100"></td>
                                        <td></td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputText  value="Frente " />
                                    </td>
                                    <td>
                                    <p:spinner id="spinnerFrente" size="3" value="#{cadastroMB.projeto.terreno.frente}"  min="0" >
                                        <p:ajax update="spinnerLateral, spinnerFrente, resulField" process="@this" />
                                    </p:spinner>
                                    </td>
                                    <td>
                                    <h:outputText value="Lateral " />
                                    </td>
                                    <td>
                                    <p:spinner id="spinnerLateral" size="3" value="#{cadastroMB.projeto.terreno.lateral}"  min="0" >
                                        <p:ajax update="spinnerLateral, spinnerFrente, resulField" process="@this" />
                                    </p:spinner>
                                    
                                    </td>
                                    <td>
                                    <h:outputText value="Pavimentos " /></td>
                                    <td>
                                    <p:spinner size="1" id="spinnerPav" min="0"  value="#{cadastroMB.projeto.qtdPavimentos}" >
                                        <p:ajax update="spinnerLateral, spinnerFrente, resulField" process="@this" />
                                    </p:spinner>
                                    </td>
                                    <tr>
                                        <td>
                                    <h:outputText value="Total"/>
                                    </td>
                                    <td>
                                    <p:inputText value="#{cadastroMB.calcM2}" id="resulField" disabled="true" size="1" /> m2</td>
                                    </tr>
                                    </tr>
                                </table>
                            </fieldset>
                            <br/><p:separator/>
                            <tr class="linha">
                                <td>

                                    <h3 style="margin-top:0">Detalhes do Projeto</h3>
                            <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
                                <p:outputLabel for="padrao" value="Padrão: " />
                                <p:selectOneRadio  immediate="true" id="padrao" value="#{cadastroMB.projeto.tipo}">
                                    <f:selectItem itemLabel="Basico" itemValue="Basico" />
                                    <f:selectItem itemLabel="Normal" itemValue="Normal" />
                                    <p:ajax process="@this"/>
                                    <p:ajax update="selectListComodos" listener="#{cadastroMB.filterComodosList}"/>
                                </p:selectOneRadio>
                            </h:panelGrid>
                            </td>
                            </tr>
                            <p:separator/>
                            <!-- Inicio Drag Drop Comodos -->
                            <h:panelGrid width="100%" columns="3" cellpadding="5">
                                <p:selectOneListbox  converter="objectConverter" immediate="true" value="#{cadastroMB.selectedComodo}" id="selectListComodos" var="com"
                                                     filter="true" filterMatchMode="contains" >
                                    <f:selectItems  value="#{cadastroMB.comodos}" var="comodo" itemLabel="#{comodo.tipo}" itemValue="#{comodo}" />
                                    <p:column>
                                        <h:outputText value="#{com.tipo}" />
                                    </p:column>
                                </p:selectOneListbox>
                                <p:commandButton  value=">>>>>" actionListener="#{cadastroMB.addComodoEmComodosSelecionados}" update="comodosSelecionados" />
                                <p:dataTable var="comSelecteds" id="comodosSelecionados" 
                                             scrollable="true" scrollHeight="200"
                                             selectionMode="single"
                                             rowKey="#{comSelecteds.id}"
                                             value="#{cadastroMB.comodosSelecionados}">
                                    <p:column headerText="Descricao">
                                        <h:outputText value="#{comSelecteds.tipo}" />
                                    </p:column>
                                    <p:column headerText="Tamanho Medio">
                                        <h:outputText value="#{comSelecteds.tamMedio}" />
                                    </p:column>
                                    <p:column headerText="Ação"  style="width: 30%">
                                        <p:commandButton style="width: 30%; height: 30px" 
                                                         icon="ui-icon-trash" 
                                                         actionListener="#{cadastroMB.removeComodoEmComodosSelecionados(comSelecteds)}" >

                                        </p:commandButton>
                                        <p:commandButton style="width: 30%; height: 30px" icon="ui-icon-search" />
                                    </p:column>
                                </p:dataTable>
                            </h:panelGrid>
                            <!-- Fim Drag Drop Comodos -->
                            <p:separator/>
                            <tr class="linha">
                                <td>
                            <h:outputText value="Mesmo endereço do cliente? "/> 
                            <p:selectBooleanCheckbox valueChangeListener="#{cadastroMB.copiarEnderecoCliente()}" value="#{cadastroMB.copiarEndereco}">
                                <p:ajax process="@this"  update="ProjetoRua, projetoBairro, projetoNumero, projetoEstado, projetoCep, projetoCidade"  />
                            </p:selectBooleanCheckbox> </td>

                            </tr>
                            <p:separator/>

                            <fieldset>
                                <legend>Endereco da Obra</legend>
                                <table>

                                    <tr class="linha">
                                        <td class="padraoColuna-200"></td>
                                        <td></td>
                                        <td class="padraoColuna-100"></td>
                                        <td></td>
                                    </tr>

                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Rua"/></td>
                                    <td>
                                    <p:inputText id="ProjetoRua" value="#{cadastroMB.projeto.endereco.rua}" size="30" label="rua" />
                                    </td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Bairro"/></td>
                                    <td>
                                    <p:inputText id="projetoBairro" value="#{cadastroMB.projeto.endereco.bairro}" size="30" label="rua" />
                                    </td>
                                    <td>
                                    <h:outputText value="Numero "/>
                                    </td>
                                    <td><p:inputText id="projetoNumero" size="8" value="#{cadastroMB.projeto.endereco.numero}" label="Numero" /></td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Cidade "/></td>
                                    <td >
                                    <p:inputText id="projetoCidade" value="#{cadastroMB.projeto.endereco.cidade}" size="30" label="Cidade" />
                                    </td>
                                    <td>
                                    <h:outputText value="Cep "/>
                                    </td>
                                    <td><p:inputMask id="projetoCep" mask="99.999-999" size="8" value="#{cadastroMB.projeto.endereco.cep}" label="Cep" /></td>
                                    </tr>
                                    <tr class="linha">
                                        <td>
                                    <h:outputLabel value="Estado"/></td>
                                    <td>
                                    <p:inputText id="projetoEstado" value="#{cadastroMB.projeto.endereco.estado}" size="50" label="Estado" />
                                    </td>
                                    </tr>
                                </table>
                            </fieldset>
                        </p:panel>
                    </p:tab>
                    <p:tab id="servicos" title="Serviços" >
                        <p:panel header="Seleção de Serviços" style="width: 100%">
                            <!--Inicio Projetos -->
                            <h:panelGrid columns="3" cellpadding="5">
                                <h:outputLabel for="menuProjetos" value="Projetos: " />
                                <p:selectCheckboxMenu converter="objectConverter" id="menuProjetos"  value="#{cadastroMB.selectedServicosProjetos}" label="Selecione Aqui"
                                                      filter="true" filterMatchMode="contains" panelStyle="width:250px">
                                    <f:selectItems var="proj" itemLabel="#{proj.descricao}" itemValue="#{proj}" value="#{cadastroMB.servicosProjetos}" />
                                </p:selectCheckboxMenu>
                                <p:commandButton value="Adicionar" style="height: 29px; text-align: center" icon="ui-icon-check" update="displayProjetos" />
                            </h:panelGrid>

                            <p:outputPanel id="displayProjetos" style="width:250px;padding-left:5px;margin-top:10px">
                                <p:dataList value="#{cadastroMB.selectedServicosProjetos}" var="projeto" emptyMessage="Nenhum Projeto">
                                    #{projeto.descricao}
                                </p:dataList>
                            </p:outputPanel>
                            <!--Fim Projetos -->

                            <!--Inicio Servicos -->
                            <h:panelGrid columns="3" cellpadding="5">
                                <h:outputLabel for="menuServicos" value="Serviço: " />
                                <p:selectCheckboxMenu converter="objectConverter" id="menuServicos"  value="#{cadastroMB.selectedServicosServicos}" label="Selecione Aqui"
                                                      filter="true" filterMatchMode="contains" panelStyle="width:250px">
                                    <f:selectItems var="ser" itemLabel="#{ser.descricao}" itemValue="#{ser}" value="#{cadastroMB.servicosServicos}" />
                                </p:selectCheckboxMenu>
                                <p:commandButton value="Adicionar" style="height: 29px; text-align: center" icon="ui-icon-check" update="displayServicos" />
                            </h:panelGrid>

                            <p:outputPanel id="displayServicos" style="width:250px;padding-left:5px;margin-top:10px">
                                <p:dataList value="#{cadastroMB.selectedServicosServicos}" var="servico" emptyMessage="Nenhum Serviço">
                                    #{servico.descricao}
                                </p:dataList>
                            </p:outputPanel>

                            <!--Fim Servicos -->

                            <!--Inicio Outros -->

                            <h:panelGrid columns="3" cellpadding="5">
                                <h:outputLabel for="menuOutros" value="Outros: " />
                                <p:selectCheckboxMenu converter="objectConverter" id="menuOutros"  value="#{cadastroMB.selectedServicosOutros}" label="Selecione Aqui"
                                                      filter="true" filterMatchMode="contains" panelStyle="width:250px">
                                    <f:selectItems var="out" itemLabel="#{out.descricao}" itemValue="#{out}" value="#{cadastroMB.servicosOutros}" />
                                </p:selectCheckboxMenu>
                                <p:commandButton value="Adicionar" style="height: 29px; text-align: center" icon="ui-icon-check" update="displayOutros" />
                            </h:panelGrid>

                            <p:outputPanel id="displayOutros" style="width:250px;padding-left:5px;margin-top:10px">
                                <p:dataList value="#{cadastroMB.selectedServicosOutros}" var="outro" emptyMessage="Nenhum Serviço">
                                    #{outro.descricao}
                                </p:dataList>
                            </p:outputPanel>

                            <!--Fim Outros -->
                        </p:panel>
                        <p:commandButton actionListener="#{cadastroMB.viewConfirmationProject()}" icon="ui-icon-extlink" value="Confirmar Dados"  update="growl" process="@this"/>
                    </p:tab>
                </p:wizard>
            </h:form>
        </h:body>
    </f:view>
</html>

